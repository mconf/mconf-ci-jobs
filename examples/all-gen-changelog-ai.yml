name: Generate Changelog (AI)

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to generate changelog for (e.g., v1.2.3)'
        required: true
        type: string
      previous_version:
        description: 'Previous version to compare against (leave empty to auto-detect last tag)'
        required: false
        type: string

jobs:
  generate-changelog-ai:
    permissions:
      contents: write
      pull-requests: write
      id-token: write
    uses: mconf/mconf-ci-jobs/.github/workflows/all-gen-changelog-ai.yml@main
    with:
      # version (required): Version to generate changelog for (e.g., v1.2.3)
      version: ${{ inputs.version }}
      # previous_version (optional): Previous version to compare against (auto-detects if not provided)
      previous_version: ${{ inputs.previous_version }}
      # changelog_file (optional): Path to the changelog file (default: CHANGELOG.md)
      changelog_file: 'CHANGELOG.md'
      # pr_branch_prefix (optional): Prefix for the PR branch name (default: changelog)
      pr_branch_prefix: 'auto-changelog'
      # claude_model (optional): Claude model to use - haiku, sonnet, or opus (default: haiku)
      claude_model: 'haiku'
      # runs-on (optional): JSON array of runner labels (default: ["self-hosted", "ubuntu-22.04"])
      # runs-on: '["self-hosted", "ubuntu-22.04"]'
    secrets: inherit
    # Required secrets:
    # ANTHROPIC_API_KEY: Anthropic API key for Claude
